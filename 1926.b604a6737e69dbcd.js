"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1926],{61926:(A,h,s)=>{s.r(h),s.d(h,{AddVotePageModule:()=>M});var g=s(69808),m=s(34182),n=s(65649),c=s(99800),a=s(70655),e=s(72096),p=s(48266),v=s(90849);function f(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"ion-card",2)(1,"ion-card-header")(2,"ion-row",3)(3,"ion-col",4)(4,"ion-badge",5),e._uU(5),e.qZA()(),e._UZ(6,"ion-col",6),e.qZA()(),e.TgZ(7,"ion-card-content"),e._UZ(8,"ion-img"),e.TgZ(9,"ion-row")(10,"ion-col",4)(11,"ion-card-title"),e._uU(12),e.qZA()(),e.TgZ(13,"ion-col",6)(14,"ion-button",7),e.NdJ("click",function(){const l=e.CHM(t).index;return e.oxw().votar(l+1)}),e._uU(15," VOTAR! "),e.qZA()()()()()}if(2&o){const t=r.$implicit,i=r.index;e.xp6(5),e.hij(" ",i+1," "),e.xp6(7),e.Oqu(t)}}const y=[{path:"",component:(()=>{class o{constructor(t,i,d,l,u,P,V){this.authService=t,this.alertController=i,this.toastController=d,this.loadingController=l,this.storage=u,this.route=P,this.router=V,this.nameCandidatosVotacion=[],this.voterToken=""}ngOnInit(){return(0,a.mG)(this,void 0,void 0,function*(){if(yield this.presentLoading(),yield this.storage.create(),this.voterToken=this.route.snapshot.paramMap.get("codTkn"),this.addrr=this.route.snapshot.paramMap.get("addr"),yield this.authService.checkMetaMask()){yield this.presentToastMetaConnected();const i=yield this.authService.getVoteByVoter(this.addrr);i?(this.nameCandidatosVotacion=yield this.authService.getCandidates(i.candidatecount,this.addrr),this.voterToken?this.loading.dismiss():(this.loading.dismiss(),yield this.presentNoTokenToVote())):(this.loading.dismiss(),yield this.presentNoVoteByAddress())}else this.loading.dismiss(),yield this.presentNoMetaAlert()})}presentLoading(){return(0,a.mG)(this,void 0,void 0,function*(){this.loading=yield this.loadingController.create({cssClass:"my-custom-class",message:"Conectando con la Blockchain..."}),yield this.loading.present()})}presentNoMetaAlert(){return(0,a.mG)(this,void 0,void 0,function*(){const t=yield this.alertController.create({cssClass:"my-custom-class",header:"Necesitas Metamask para utilizar CleanVote",subHeader:"Por favor, instala metamask y recarga la pagina",backdropDismiss:!1});yield t.present();const{role:i}=yield t.onDidDismiss();console.log("onDidDismiss resolved with role",i)})}presentToastMetaConnected(){return(0,a.mG)(this,void 0,void 0,function*(){(yield this.toastController.create({message:"\xa1Metamask Conectado!",duration:2e3})).present()})}presentNoVoteByAddress(){return(0,a.mG)(this,void 0,void 0,function*(){const t=yield this.alertController.create({cssClass:"my-custom-class",header:"No existe una Votacion Vigente para ese c\xf3digo.",subHeader:"Por favor, revisalo y escribelo nuevamente",backdropDismiss:!1});yield t.present();const{role:i}=yield t.onDidDismiss();console.log("onDidDismiss resolved with role",i)})}presentNoTokenToVote(){return(0,a.mG)(this,void 0,void 0,function*(){const t=yield this.alertController.create({cssClass:"my-custom-class",header:"No tienes token para votar!.",subHeader:"Por favor, ingresa nuevamente al link de Votacion para Autenticarte",backdropDismiss:!1});yield t.present();const{role:i}=yield t.onDidDismiss();console.log("onDidDismiss resolved with role",i)})}votar(t){return(0,a.mG)(this,void 0,void 0,function*(){yield this.presentAlertConfirmVote(t)})}presentAlertConfirmVote(t){return(0,a.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create({cssClass:"my-custom-class",header:"\xbfConfirmas tu Voto a "+this.nameCandidatosVotacion[t-1]+" ?",message:"Esta acci\xf3n no se puede deshacer.",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",id:"cancel-button",handler:d=>{console.log("Confirm Cancel: blah")}},{text:"Okay",id:"confirm-button",handler:()=>(0,a.mG)(this,void 0,void 0,function*(){console.log("Confirm Okay"),yield this.presentLoading();const d=yield this.authService.votar(this.addrr,t,this.voterToken);null!=d.transactionHash?(this.loading.dismiss(),this.router.navigateRoot("/vote-const/"+d.transactionHash+"/"+this.addrr)):(this.loading.dismiss(),yield this.presentErrorVoting())})}]})).present()})}presentErrorVoting(){return(0,a.mG)(this,void 0,void 0,function*(){const t=yield this.alertController.create({cssClass:"my-custom-class",header:"Hubo un error al cargar tu voto.",subHeader:"Por favor, recarga la pagina e intenta nuevamente",backdropDismiss:!1});yield t.present();const{role:i}=yield t.onDidDismiss();console.log("onDidDismiss resolved with role",i)})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(p.X),e.Y36(n.Br),e.Y36(n.yF),e.Y36(n.HT),e.Y36(v.K),e.Y36(c.gz),e.Y36(n.SH))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-add-vote"]],decls:7,vars:1,consts:[["color","tertiary"],["class","card-establecimiento",4,"ngFor","ngForOf"],[1,"card-establecimiento"],[1,"ion-align-items-center"],["size","6"],["color","warning","mode","ios"],["size","6",1,"ion-text-right"],["size","large",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),e._uU(3,"\xa1Elije un Candidato para votar!"),e.qZA()()(),e.TgZ(4,"ion-content"),e._UZ(5,"br"),e.YNc(6,f,16,2,"ion-card",1),e.qZA()),2&t&&(e.xp6(6),e.Q6J("ngForOf",i.nameCandidatosVotacion))},directives:[n.Gu,n.sr,n.wd,n.W2,g.sg,n.PM,n.Zi,n.Nd,n.wI,n.yp,n.FN,n.Xz,n.Dq,n.YG],styles:["ion-item[_ngcontent-%COMP%]{--background: #316dd0}ion-item[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-weight:700;font-size:20px;color:#fff}ion-item[_ngcontent-%COMP%]:last-of-type{border-radius:0 0 20% 20%}ion-item[_ngcontent-%COMP%]:last-of-type   div[_ngcontent-%COMP%]{padding-bottom:20px}ion-searchbar[_ngcontent-%COMP%]{--box-shadow: none;--border-radius: 10px;opacity:.96;padding:0;margin:12px 0}ion-content[_ngcontent-%COMP%]{--background: #f6f6f6}ion-card[_ngcontent-%COMP%]{margin:0 0 22px;padding:6px;box-shadow:none;box-shadow:0 3px 15px #00000029;border-radius:30px}ion-card[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{width:200px;margin:0 auto}ion-slide[_ngcontent-%COMP%]{padding:10px}ion-col[_ngcontent-%COMP%]{width:100%!important}.card-establecimiento[_ngcontent-%COMP%]{width:100%}"]}),o})()}];let C=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[c.Bz.forChild(y)],c.Bz]}),o})(),M=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[g.ez,m.u5,n.Pc,C]]}),o})()}}]);